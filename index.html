<!DOCTYPE html>
<html lang="en">
<head>
<!-- Favicon -->
<link rel="icon" type="image/png" href="images/ok_favicon.png" sizes="32x32">
<link rel="apple-touch-icon" href="images/ok_favicon.png">
<meta name="theme-color" content="#000000">

<!-- Mobile layout -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO -->
    <title>omar kareim | art gallery</title>
    <meta name="description" content="Explore the multidimensional artwork of Omar Kareim — a fusion of cultural symbolism and spirituality. View mixed-media works, abstraction, portraiture, and immersive visual narratives.">

    <!-- OpenGraph (Social Sharing) -->
    <meta property="og:title" content="Omar Kareim | Virtual Art Gallery">
    <meta property="og:description" content="Experience the artwork of Omar Kareim — symbolic, culturally layered. Explore the gallery.">
    <meta property="og:image" content="https://omarkareim.art/images/og-image.jpg">
    <meta property="og:url" content="https://omarkareim.art">
    <meta property="og:type" content="website">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Omar Kareim | Virtual Art Gallery">
    <meta name="twitter:description" content="Experience the artwork of Omar Kareim.">
    <meta name="twitter:image" content="https://omarkareim.art/images/og-image.jpg">

    <meta http-equiv="cache-control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="0">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        html {scroll-behavior: smooth;}
        body{font-family:'Georgia',serif;background:#0a0a0a;color:#f5f5f5;overflow-x:hidden;user-select:none}
        .landing{height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center;background:linear-gradient(135deg,#1a1a1a 0%,#0a0a0a 100%);position:relative;overflow:hidden}
        .landing::before{content:'';position:absolute;width:500px;height:500px;background:radial-gradient(circle,rgba(218,165,32,0.1)0%,transparent 70%);top:50%;left:50%;transform:translate(-50%,-50%);animation:pulse 4s ease-in-out infinite}
        @keyframes pulse{0%,100%{transform:translate(-50%,-50%)scale(1);opacity:.3}50%{transform:translate(-50%,-50%)scale(1.2);opacity:.5}}
        h1{font-size:4rem;font-weight:300;letter-spacing:.3rem;margin-bottom:1rem;background:linear-gradient(135deg,#daa520,#f4e4c1);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;animation:fadeInUp 1s ease-out}
        .subtitle{font-size:1.5rem;letter-spacing:.5rem;color:#daa520;margin-bottom:3rem;font-weight:300;animation:fadeInUp 1s ease-out .3s both;text-align:center;text-transform:lowercase}
        @keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
        .scroll-indicator{position:absolute;bottom:40px;font-size:.9rem;color:#daa520;letter-spacing:.2rem;opacity:0.7;animation:bounce 2s infinite}
        @keyframes bounce{0%,20%,50%,80%,100%{transform:translateY(0)}40%{transform:translateY(-10px)}60%{transform:translateY(-5px)}}
        .gallery-section{min-height:100vh;padding:100px 5%;background:#0a0a0a}
        .section-title{text-align:center;font-size:2.5rem;margin-bottom:60px;color:#daa520;letter-spacing:.3rem;font-weight:300}
        .gallery-wrapper{overflow-x:auto;scroll-behavior:smooth;scrollbar-width:thin;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;padding-bottom:20px;cursor:grab;position:relative}
        .gallery-wrapper:hover{scrollbar-width:auto}
        .gallery-wrapper:active{cursor:grabbing}
        .gallery-wrapper::-webkit-scrollbar{display:none}
        .gallery-wrapper:hover::-webkit-scrollbar{display:block}
        .gallery-wrapper::-webkit-scrollbar-thumb{background:rgba(218,165,32,.5);border-radius:10px}
        .gallery-grid{display:flex;gap:30px}
        .gallery-item{flex:0 0 350px;position:relative;overflow:hidden;border-radius:8px;cursor:pointer;transition:transform .3s,box-shadow .3s;background:#1a1a1a;opacity:0;animation:fadeInGallery 0.8s ease forwards}
        @keyframes fadeInGallery{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
        .gallery-item:hover{transform:translateY(-10px);box-shadow:0 20px 40px rgba(218,165,32,.3)}
        .gallery-item img{width:100%;height:400px;object-fit:cover;display:block;transition:transform .5s}
        .gallery-item:hover img{transform:scale(1.05)}
        .gallery-details{padding:15px;text-align:left}
        .gallery-details h3{font-size:1.2rem;color:#daa520;margin-bottom:5px;font-weight:500;line-height:1.3}
        .gallery-details p{font-size:.9rem;color:#ccc;margin-bottom:3px}
        .auto-scroll-left,.auto-scroll-right{position:absolute;top:50%;transform:translateY(-50%);width:60px;height:60px;background:rgba(218,165,32,.3);border-radius:50%;display:flex;align-items:center;justify-content:center;color:#daa520;font-size:1.8rem;cursor:pointer;z-index:10;opacity:0.7;transition:opacity .3s}
        .auto-scroll-left:hover,.auto-scroll-right:hover{opacity:1;background:rgba(218,165,32,.5)}
        .auto-scroll-left{left:20px}.auto-scroll-right{right:20px}
        .auto-scroll-left::before{content:'<'} .auto-scroll-right::before{content:'>'}
        .vr-section{padding:100px 5%;text-align:center;background:linear-gradient(180deg,#0a0a0a 0%,#1a1a1a 100%)}
        .vr-button{display:inline-block;padding:20px 50px;font-size:1.2rem;letter-spacing:.2rem;color:#0a0a0a;background:linear-gradient(135deg,#daa520,#f4e4c1);border:none;border-radius:50px;cursor:pointer;transition:all .3s;font-family:'Georgia',serif;box-shadow:0 10px 30px rgba(218,165,32,.3)}
        .vr-button:hover{transform:translateY(-3px) scale(1.05);box-shadow:0 15px 40px rgba(218,165,32,.5)}
        .section-fade{opacity:0;transform:translateY(40px);transition:opacity .9s cubic-bezier(0.22,0.61,0.36,1),transform .9s cubic-bezier(0.22,0.61,0.36,1);}
        .section-fade.visible{opacity:1;transform:translateY(0);}
        .about-section{padding:100px 5%;background:#0a0a0a;display:flex;flex-direction:column;align-items:center}
        .about-container{max-width:900px;display:flex;gap:50px;align-items:flex-start}
        .about-photo{flex-shrink:0}
        .about-photo img{width:250px;height:250px;border-radius:50%;object-fit:cover;border:4px solid #daa520;box-shadow:0 10px 30px rgba(218,165,32,.3)}
.about-text{flex:1}
.about-text h2{
    font-size:2.5rem;
    color:#daa520;
    margin-bottom:30px;
    letter-spacing:.3rem;
    font-weight:300;
    text-align:left;
}

/* CONTACT SECTION STYLES */
.contact-section {
    padding: 80px 5% 100px;
    background:#0a0a0a;
    display:flex;
    justify-content:center;
}
.contact-inner {
    max-width:800px;
    width:100%;
    text-align:center;
    border-top:1px solid #333;
    padding-top:40px;
}
.contact-title {
    font-size:2rem;
    color:#daa520;
    letter-spacing:.3rem;
    font-weight:300;
    margin-bottom:20px;
}
.contact-text {
    font-size:1.05rem;
    line-height:1.8;
    color:#f5f5f5;
    margin-bottom:20px;
}
.contact-email a {
    font-size:1.2rem;
    color:#daa520;
    text-decoration:none;
    border-bottom:2px solid #daa520;
    padding-bottom:3px;
}
.contact-email a:hover {
    opacity:0.85;
}
.contact-note {
    font-size:0.85rem;
    color:#aaaaaa;
    margin-top:15px;
    letter-spacing:.12rem;
    text-transform:uppercase;
}  
.about-text p{font-size:1.1rem;line-height:1.8;color:#f5f5f5;margin-bottom:20px;text-align:left}
        .lightbox{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.95);z-index:3000;justify-content:center;align-items:center;overflow:hidden}
        .lightbox.active{display:flex}
        .lightbox-content{display:flex;max-width:90%;max-height:90vh;gap:40px;align-items:flex-start;flex-wrap:nowrap;position:relative}
        .lightbox img{max-width:70%;max-height:90vh;object-fit:contain;border-radius:8px}
        .lightbox-details{max-width:30%;color:#f5f5f5;padding-top:20px;word-wrap:break-word;overflow-wrap:break-word;hyphens:auto}
        .lightbox-details h3{font-size:2rem;color:#daa520;margin-bottom:15px;font-weight:500}
        .lightbox-details p{font-size:1.1rem;line-height:1.6;margin-bottom:10px;color:#f5f5f5}
        .lightbox-close{position:absolute;top:20px;right:20px;font-size:2rem;color:#daa520;cursor:pointer;width:44px;height:44px;display:flex;align-items:center;justify-content:center;background:rgba(26,26,26,.7);border-radius:50%;transition:transform .3s,background .3s;z-index:3001}
        .lightbox-close:hover{background:#daa520;color:#0a0a0a;transform:scale(1.1)}
        .lightbox-nav{position:absolute;top:50%;transform:translateY(-50%);width:50px;height:50px;background:rgba(218,165,32,.3);border-radius:50%;display:flex;align-items:center;justify-content:center;color:#daa520;font-size:1.8rem;cursor:pointer;z-index:3001;opacity:0.7}
        .lightbox-nav:hover{opacity:1;background:rgba(218,165,32,.5)}
        .lightbox-prev{left:20px}
        .lightbox-next{right:20px}
        .vr-gallery{display:none;position:fixed;top:0;left:0;width:100%;height:100%;z-index:2000;background:#000;cursor:default}
        .vr-gallery.active{display:block}
        .vr-exit{position:fixed;top:20px;left:20px;padding:15px 30px;background:rgba(218,165,32,.9);color:#0a0a0a;border:none;border-radius:30px;cursor:pointer;z-index:2001;font-size:1rem;letter-spacing:.1rem;transition:all .3s}
        .vr-exit:hover{background:#daa520;transform:scale(1.05)}
        .zoom-controls{position:fixed;top:20px;right:20px;display:flex;gap:10px;z-index:2001}
        .zoom-button{padding:12px 20px;background:rgba(218,165,32,.9);color:#0a0a0a;border:none;border-radius:30px;cursor:pointer;font-size:1rem;letter-spacing:.1rem;transition:all .3s}
        .zoom-button:hover{background:#daa520;transform:scale(1.05)}
        @media (max-width: 768px) {
            h1 {font-size:2.5rem; letter-spacing:.2rem;}
            .subtitle {font-size:1rem; letter-spacing:.3rem;}
            .section-title {font-size:1.8rem;}
            .gallery-item {flex:0 0 280px;}
            .gallery-item img {height:320px;}
            .gallery-details h3 {font-size:1rem;}
            .gallery-details p {font-size:0.8rem;}
            .lightbox-content {flex-direction:column; gap:20px; max-height:90vh; overflow-y:auto;}
            .lightbox img {max-width:100%; max-height:50vh; flex-shrink:0;}
            .lightbox-details {max-width:100%; padding:15px; background:rgba(26,26,26,.8); border-radius:8px;}
            .lightbox-details h3 {font-size:1.6rem;}
            .vr-exit {padding:10px 20px; font-size:0.85rem;}
            .zoom-controls {flex-direction:column; gap:8px;}
            .zoom-button {padding:8px 16px; font-size:0.85rem;}
            .about-container {flex-direction:column; align-items:center; gap:30px;}
            .about-photo img {width:200px; height:200px;}
            .about-text h2 {font-size:1.8rem; text-align:center;}
            .about-text p {font-size:1rem; text-align:center;}
            .vr-button {padding:16px 40px; font-size:1rem;}
            .auto-scroll-left, .auto-scroll-right {width:50px; height:50px; font-size:1.5rem;}
            .lightbox-nav {width:40px; height:40px; font-size:1.4rem;}
        }
        @media (max-width: 480px) {
            h1 {font-size:2rem;}
            .subtitle {font-size:0.9rem;}
            .gallery-item {flex:0 0 240px;}
            .gallery-item img {height:280px;}
        }
    </style>
</head>
<body>

<!-- LANDING -->
<section class="landing">
    <h1>OMAR KAREIM</h1>
    <p class="subtitle">gallery of art</p>
    <div class="scroll-indicator">SCROLL</div>
</section>

<!-- 2D GALLERY -->
<section class="gallery-section section-fade">
    <h2 class="section-title">GALLERY</h2>
    <div class="gallery-wrapper">
        <div class="gallery-grid" id="galleryGrid"></div>
        <div class="auto-scroll-left"><</div>
        <div class="auto-scroll-right">></div>
    </div>
</section>

<!-- VR SECTION (moved right after gallery) -->
<section class="vr-section section-fade">
    <button class="vr-button" id="enterVR">ENTER VIRTUAL GALLERY</button>
</section>

<!-- ABOUT SECTION -->
<section class="about-section section-fade">
    <div class="about-container">
        <div class="about-photo">
            <img src="images/omar_kareim_profile.webp" alt="Omar Kareim">
        </div>
        <div class="about-text">
            <h2>ABOUT</h2>
            <p>Omar Kareim is a contemporary visual artist whose work brings together cultural symbolism, spirituality, and the quiet logic of the digital world. Raised in the Midwest, his path into art began simply through observation, curiosity, and a desire to understand how things connect. That early sense of wonder still guides his practice today.</p>
            <p>Kareim’s work is shaped by the idea that meaning often lives in the spaces between things. He uses layered forms, precise detail, and intentional color to explore how traditions, beliefs, and personal histories overlap. His compositions invite viewers to slow down, notice patterns, and consider the relationships woven beneath the surface.</p>
            <p>Although his subjects often reach into big ideas, Kareim approaches his art with humility. Each piece is a study, an attempt to gather thoughts, reconcile influences, and express something honest. His background in technical fields informs his structure and discipline, while his creative instincts bring warmth, symbolism, and humanity to the work. The result is a visual language rooted in stillness and curiosity, connecting the ancient and the contemporary in subtle, thoughtful ways.</p>
        </div>
    </div>
</section>

<!-- CONTACT SECTION -->
<section class="contact-section section-fade">
    <div class="contact-inner">
        <h2 class="contact-title">CONTACT</h2>
        <p class="contact-text">
            For inquiries about artwork, commissions, or exhibitions, you’re welcome to reach out directly.
        </p>
        <p class="contact-email">
            <a href="mailto:contact@omarkareim.art">contact@omarkareim.art</a>
        </p>
        <p class="contact-note">
            Instagram: coming soon
        </p>
    </div>
</section>

<!-- LIGHTBOX CAROUSEL -->
<div class="lightbox" id="lightbox">
    <div class="lightbox-content">
        <img id="lightboxImg" src="" alt="">
        <div class="lightbox-details">
            <h3 id="lightboxTitle"></h3>
            <p id="lightboxMedium"></p>
            <p id="lightboxDate"></p>
            <p id="lightboxDesc"></p>
        </div>
    </div>
    <div class="lightbox-close">×</div>
    <div class="lightbox-nav lightbox-prev"><</div>
    <div class="lightbox-nav lightbox-next">></div>
</div>

<!-- VR GALLERY -->
<div class="vr-gallery" id="vrGallery">
    <button class="vr-exit" id="exitVR">EXIT</button>
    <div class="zoom-controls">
        <button class="zoom-button" id="zoomIn">ZOOM +</button>
        <button class="zoom-button" id="zoomOut">ZOOM −</button>
        <button class="zoom-button" id="resetZoom">RESET</button>
    </div>
    <canvas id="vrCanvas"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
<script>
const artworkData = [
    // 1. Axis Mundi (main)
    { file: 'images/artwork1.webp', fallback: 'images/artwork1.png', title: 'Axis Mundi', medium: 'Acrylic on Canvas', date: '2025', description: 'A sweeping exploration of human interconnectedness, belief, and belonging, this monumental work unifies diverse spiritual and cultural iconographies within a cosmological framework. Elements of earth, wind, fire, and water serve as anchoring forces, binding the narrative across traditions. At its center stands the Shroud of Turin, framed by symbols that span Abrahamic faiths, ancient mythologies, and contemporary metaphysics. The figure on the far right - “Goddess of the Information Age” - introduces a tension between the ancient and the digital, suggesting a future in which wisdom, technology, and spirituality converge. The result is a visual codex: a map of humanity’s shared search for meaning.' },

    // 2. Axis Mundi (supporting)
    { file: 'images/artwork2.webp', fallback: 'images/artwork2.png', title: 'Axis Mundi', medium: 'Acrylic on Canvas', date: '2025', description: '' },

    // 3. El Dorado (supporting)
    { file: 'images/artwork3.webp', fallback: 'images/artwork3.png', title: 'El Dorado', medium: 'Acrylic on Canvas', date: '2025', description: '' },

    // 4. El Dorado (main)
    { file: 'images/artwork4.webp', fallback: 'images/artwork4.png', title: 'El Dorado', medium: 'Acrylic on Canvas', date: '2025', description: 'A dynamic fusion of classical form and contemporary iconography, this portrait reimagines Lionel Messi through a Greco-Roman lens - elevating an athlete into the realm of myth. Sculptural gold leaf accentuates his profile, evoking both heroic statuary and regal ornamentation, while roses intertwine as symbols of honor, admiration, and legacy. Set against an expressive modern background, the piece functions as a visual homage to the idea of “giving them their flowers” - celebrating greatness not as spectacle, but as a timeless human pursuit.' },

    // 5. Mjolnir – YES, fully restored with your exact description
    { file: 'images/artwork5.webp', fallback: 'images/artwork5.png', title: 'Mjolnir: Forge of Resilience', medium: 'Acrylic and Ink on Canvas', date: '2023', description: 'Echoing the mythical hammer of Thor, this intricate work embodies resilience, sovereignty, and the raw force of creation. The form of Mjolnir emerges through a labyrinth of linework - part sigil, part circuitry, suggesting the convergence of ancient power and modern symbolic languages. Its unexpected uterine silhouette introduces a compelling duality: destruction and creation, war and fertility, chaos and regeneration. This tension reframes the hammer not merely as a weapon of the gods, but as a vessel for rebirth through struggle.' },

    // 8. φ - new addition to gallery
    { file: 'images/artwork8.webp', fallback: 'images/artwork8.png', title: 'φ', medium: 'Acrylic on Canvas',
    date: '2025', description: 'φ explores the meeting point between human motion and mathematical harmony. At the center of the composition, a silhouetted figure rises through a field of textured red, suspended in a moment that suggests both physical leap and spiritual ascent. Surrounding the figure are equations drawn from physics and mathematics, including the golden ratio, whose symbol gives the work its title.\n\nThese inscriptions serve as quiet anchors, grounding the composition in the structures that underlie the natural world. Against this ordered framework, the figure’s upward movement introduces an element of intuition and possibility. The tension between precision and transcendence becomes the focus of the piece, inviting viewers to consider how rational knowledge and inner experience can coexist.\n\nThe result is a meditation on form, growth, and the search for balance - an ascent shaped equally by the measurable and the immeasurable.' },

    // 6. Invocation to Rise (main 2025)
    { file: 'images/artwork9.webp', fallback: 'images/artwork9.png', title: 'Invocation to Rise', medium: 'Acrylic on Canvas', date: '2025', description: 'In Invocation to Rise, the concentric bands and runic text encircle a gold plane where a faint horizon glimmers, like a doorway waiting in the light. The painting becomes an illuminated invocation - part prayer, part portal - quietly guiding the viewer toward elevation. Its language is subtle, encoded, and ancient, inviting those who linger to sense the threshold woven into its heart.' },

    // 6. Stargate (main 2012)
    { file: 'images/artwork6.webp', fallback: 'images/artwork6.png', title: 'Stargate', medium: 'Acrylic on Canvas', date: '2012', description: 'An evocative abstract meditation on transition and possibility, Stargate captures the moment just before emergence - when the familiar dissolves and the unknown begins to take shape. The central circular form, both portal and boundary, anchors the composition as sweeping lines and fragmented geometric marks swirl around it like remnants of past structures. Gold fields meet deep shadow, suggesting the meeting point between illumination and obscurity, intention and uncertainty. This work embodies the quiet power of liminality: the space where identity, direction, and meaning are actively formed.' },

    // 7. Stargate (supporting 2012)
    { file: 'images/artwork7.webp', fallback: 'images/artwork7.png', title: 'Stargate', medium: 'Acrylic on Canvas', date: '2012', description: '' }
];

/* ===== GALLERY BUILDER ===== */
const grid = document.getElementById('galleryGrid');
artworkData.forEach((art, i) => {
    const item = document.createElement('div');
    item.className = 'gallery-item';
    item.style.animationDelay = `${i * 0.1}s`;
    item.onclick = () => openLightbox(i);

    const img = document.createElement('img');
    img.src = art.file;
    img.alt = art.title;
    img.onerror = () => img.src = art.fallback;

    const details = document.createElement('div');
    details.className = 'gallery-details';
    details.innerHTML = `<h3>${art.title}</h3><p>${art.medium} • ${art.date}</p>`;

    item.appendChild(img);
    item.appendChild(details);
    grid.appendChild(item);
});

/* ===== LIGHTBOX, VR, SCROLL, ETC. (unchanged from previous working version) ===== */
// ... (all the existing JS remains exactly the same – only the artworkData titles were updated)

const lightbox = document.getElementById('lightbox');
const lbImg = document.getElementById('lightboxImg');
const lbTitle = document.getElementById('lightboxTitle');
const lbMedium = document.getElementById('lightboxMedium');
const lbDate = document.getElementById('lightboxDate');
const lbDesc = document.getElementById('lightboxDesc');
const closeBtn = document.querySelector('.lightbox-close');
const prevBtn = document.querySelector('.lightbox-prev');
const nextBtn = document.querySelector('.lightbox-next');
let currentIdx = 0;

function openLightbox(idx) {
    currentIdx = idx;
    updateLightbox();
    lightbox.classList.add('active');
    document.body.style.overflow = 'hidden';
}
function updateLightbox() {
    const art = artworkData[currentIdx];
    lbImg.src = art.file;
    lbImg.onerror = () => lbImg.src = art.fallback;
    lbTitle.textContent = art.title;
    lbMedium.textContent = art.medium;
    lbDate.textContent = art.date;
    lbDesc.textContent = art.description || '';
    prevBtn.style.display = currentIdx > 0 ? 'flex' : 'none';
    nextBtn.style.display = currentIdx < artworkData.length - 1 ? 'flex' : 'none';
}
function closeLightbox() {
    lightbox.classList.remove('active');
    document.body.style.overflow = '';
}

closeBtn.onclick = closeLightbox;
prevBtn.onclick = () => { if (currentIdx > 0) openLightbox(currentIdx - 1); };
nextBtn.onclick = () => { if (currentIdx < artworkData.length - 1) openLightbox(currentIdx + 1); };
lightbox.onclick = e => { if (e.target === lightbox) closeLightbox(); };
document.addEventListener('keydown', e => {
    if (!lightbox.classList.contains('active')) return;
    if (e.key === 'ArrowLeft' && currentIdx > 0) openLightbox(currentIdx - 1);
    if (e.key === 'ArrowRight' && currentIdx < artworkData.length - 1) openLightbox(currentIdx + 1);
    if (e.key === 'Escape') closeLightbox();
});

let touchStartX = 0;
lightbox.addEventListener('touchstart', e => touchStartX = e.touches[0].clientX);
lightbox.addEventListener('touchend', e => {
    const touchEndX = e.changedTouches[0].clientX;
    if (touchStartX - touchEndX > 50 && currentIdx < artworkData.length - 1) openLightbox(currentIdx + 1);
    if (touchEndX - touchStartX > 50 && currentIdx > 0) openLightbox(currentIdx - 1);
});

const wrapper = document.querySelector('.gallery-wrapper');
const leftArrow = document.querySelector('.auto-scroll-left');
const rightArrow = document.querySelector('.auto-scroll-right');

wrapper.addEventListener('scroll', () => {
    leftArrow.style.opacity = wrapper.scrollLeft > 50 ? '0.9' : '0.7';
    rightArrow.style.opacity = wrapper.scrollLeft < wrapper.scrollWidth - wrapper.clientWidth - 50 ? '0.9' : '0.7';
});
leftArrow.onclick = () => wrapper.scrollBy({left: -400, behavior: 'smooth'});
rightArrow.onclick = () => wrapper.scrollBy({left: 400, behavior: 'smooth'});

const vrBtn = document.getElementById('enterVR');
const vrGallery = document.getElementById('vrGallery');
const exitBtn = document.getElementById('exitVR');
const canvas = document.getElementById('vrCanvas');

let scene, camera, renderer, clock;
let moveF = false, moveB = false, moveL = false, moveR = false;
let vel = new THREE.Vector3();
let dir = new THREE.Vector3();
let isDraggingVR = false, prevX, prevY;
let isPointerDown = false;
let hasMoved = false;
const mouse = new THREE.Vector2();
const ray = new THREE.Raycaster();
const clickables = [];
let fov = 75, minF = 30, maxF = 100;

vrBtn.onclick = initVR;
exitBtn.onclick = () => { vrGallery.classList.remove('active'); document.body.style.overflow = ''; };

function initVR() {
    vrGallery.classList.add('active');
    document.body.style.overflow = 'hidden';
    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(fov, window.innerWidth / window.innerHeight, 0.1, 100);
    camera.position.set(0, 1.6, 5);

    renderer = new THREE.WebGLRenderer({canvas, antialias: true});
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.shadowMap.enabled = true;

    const ambient = new THREE.AmbientLight(0xffffff, 1.2);
    scene.add(ambient);
    const directional = new THREE.DirectionalLight(0xffffff, 0.8);
    directional.position.set(0, 10, 0);
    scene.add(directional);

    const floorTex = new THREE.CanvasTexture(createCheckerboard());
    floorTex.wrapS = floorTex.wrapT = THREE.RepeatWrapping;
    floorTex.repeat.set(20, 20);
    const floor = new THREE.Mesh(
        new THREE.PlaneGeometry(14, 14),
        new THREE.MeshStandardMaterial({map: floorTex, roughness: 0.8, metalness: 0.1})
    );
    floor.rotation.x = -Math.PI/2;
    floor.receiveShadow = true;
    scene.add(floor);

    const ceiling = new THREE.Mesh(
        new THREE.PlaneGeometry(14, 14),
        new THREE.MeshStandardMaterial({color: 0x111111, roughness: 0.9})
    );
    ceiling.rotation.x = Math.PI/2;
    ceiling.position.y = 5.5;
    scene.add(ceiling);

    const wallMat = new THREE.MeshStandardMaterial({color: 0x000000, roughness: 0.9});
    const walls = [
        {pos: [0, 2.75, -7], size: [14, 5.5, 0.3]},
        {pos: [-7, 2.75, 0], size: [0.3, 5.5, 14]},
        {pos: [7, 2.75, 0], size: [0.3, 5.5, 14]}
    ];
    walls.forEach(w => {
        const wall = new THREE.Mesh(new THREE.BoxGeometry(...w.size), wallMat);
        wall.position.set(...w.pos);
        scene.add(wall);
    });

    const radius = 6;
    const maxWidth = 3.5, maxHeight = 3.5;
    artworkData.forEach((art, i) => {
        const angle = (i / artworkData.length) * Math.PI * 2;
        const x = Math.sin(angle) * radius;
        const z = Math.cos(angle) * radius;
        const g = new THREE.Group();

        const img = new Image();
        img.crossOrigin = 'anonymous';
        img.src = art.file;
        img.onload = () => {
            const aspect = img.width / img.height;
            let planeWidth = maxWidth;
            let planeHeight = maxWidth / aspect;
            if (planeHeight > maxHeight) { planeHeight = maxHeight; planeWidth = maxHeight * aspect; }
            const tex = new THREE.TextureLoader().load(art.file);
            tex.colorSpace = THREE.SRGBColorSpace;
            const plane = new THREE.Mesh(
                new THREE.PlaneGeometry(planeWidth, planeHeight),
                new THREE.MeshStandardMaterial({map: tex, roughness: 0.9, metalness: 0.1})
            );
            plane.position.z = 0.06;
            plane.userData.idx = i;
            g.add(plane);
            clickables.push(plane);

            const frame = new THREE.Mesh(
                new THREE.BoxGeometry(planeWidth + 0.2, planeHeight + 0.2, 0.1),
                new THREE.MeshStandardMaterial({color: 0x000000})
            );
            g.add(frame);
        };

        g.position.set(x, 2.2, z);
        g.lookAt(0, 2.2, 0);
        scene.add(g);
    });

    clock = new THREE.Clock();
    animate();
    setupVREvents();
}

function animate() {
    requestAnimationFrame(animate);
    const delta = clock.getDelta();
    vel.multiplyScalar(0.9);
    dir.z = Number(moveF) - Number(moveB);
    dir.x = Number(moveR) - Number(moveL);
    dir.normalize();
    if (moveF || moveB) vel.z -= dir.z * 12 * delta;
    if (moveL || moveR) vel.x -= dir.x * 12 * delta;
    camera.translateX(vel.x * delta);
    camera.translateZ(vel.z * delta);
    const max = 6.5;
    camera.position.x = Math.max(-max, Math.min(max, camera.position.x));
    camera.position.z = Math.max(-max, Math.min(max, camera.position.z));

    if (isPointerDown) {
        ray.setFromCamera(mouse, camera);
        const hits = ray.intersectObjects(clickables);
        if (hits.length) {
            const idx = hits[0].object.userData.idx;
            vrGallery.classList.remove('active');
            openLightbox(idx);
            document.body.style.overflow = '';
        }
        isPointerDown = false;
    }
    renderer.render(scene, camera);
}

function setupVREvents() {
    window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    });

    document.addEventListener('keydown', e => {
        if (['KeyW','ArrowUp'].includes(e.code)) moveF = true;
        else if (['KeyS','ArrowDown'].includes(e.code)) moveB = true;
        else if (['KeyA','ArrowLeft'].includes(e.code)) moveL = true;
        else if (['KeyD','ArrowRight'].includes(e.code)) moveR = true;
    });
    document.addEventListener('keyup', e => {
        if (['KeyW','ArrowUp'].includes(e.code)) moveF = false;
        else if (['KeyS','ArrowDown'].includes(e.code)) moveB = false;
        else if (['KeyA','ArrowLeft'].includes(e.code)) moveL = false;
        else if (['KeyD','ArrowRight'].includes(e.code)) moveR = false;
    });

    canvas.addEventListener('pointerdown', e => {
        isDraggingVR = true;
        hasMoved = false;
        prevX = e.clientX; prevY = e.clientY;
    });
    canvas.addEventListener('pointermove', e => {
        if (!isDraggingVR) return;
        const dx = e.clientX - prevX, dy = e.clientY - prevY;
        if (Math.abs(dx) > 3 || Math.abs(dy) > 3) hasMoved = true;
        camera.rotation.y -= dx * 0.003;
        camera.rotation.x -= dy * 0.003;
        camera.rotation.x = Math.max(-Math.PI/2, Math.min(Math.PI/2, camera.rotation.x));
        prevX = e.clientX; prevY = e.clientY;
        mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
        mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
    });
    canvas.addEventListener('pointerup', e => {
        isDraggingVR = false;
        if (!hasMoved) {
            mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
            isPointerDown = true;
        }
    });

    let touchDragging = false;
    let touchStartDist = 0;
    let touchZoomBase = fov;

    canvas.addEventListener('touchstart', e => {
        e.preventDefault();
        if (e.touches.length === 1) {
            const t = e.touches[0];
            touchDragging = false;
            prevX = t.clientX; prevY = t.clientY;
        } else if (e.touches.length === 2) {
            const dx = e.touches[0].clientX - e.touches[1].clientX;
            const dy = e.touches[0].clientY - e.touches[1].clientY;
            touchStartDist = Math.sqrt(dx * dx + dy * dy);
            touchZoomBase = fov;
        }
    });

    canvas.addEventListener('touchmove', e => {
        e.preventDefault();
        if (e.touches.length === 1) {
            const t = e.touches[0];
            const dx = t.clientX - prevX, dy = t.clientY - prevY;
            if (Math.abs(dx) > 5 || Math.abs(dy) > 5) touchDragging = true;
            camera.rotation.y -= dx * 0.003;
            camera.rotation.x -= dy * 0.003;
            camera.rotation.x = Math.max(-Math.PI/2, Math.min(Math.PI/2, camera.rotation.x));
            prevX = t.clientX; prevY = t.clientY;
        } else if (e.touches.length === 2) {
            const dx = e.touches[0].clientX - e.touches[1].clientX;
            const dy = e.touches[0].clientY - e.touches[1].clientY;
            const dist = Math.sqrt(dx * dx + dy * dy);
            const delta = touchStartDist - dist;
            fov = Math.max(minF, Math.min(maxF, touchZoomBase + delta * 0.1));
            camera.fov = fov;
            camera.updateProjectionMatrix();
        }
    });

    canvas.addEventListener('touchend', e => {
        if (!touchDragging && e.changedTouches.length === 1) {
            const t = e.changedTouches[0];
            mouse.x = (t.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(t.clientY / window.innerHeight) * 2 + 1;
            isPointerDown = true;
        }
        if (e.touches.length < 2) touchStartDist = 0;
        touchDragging = false;
    });

    canvas.addEventListener('wheel', e => {
        e.preventDefault();
        fov = Math.max(minF, Math.min(maxF, fov + e.deltaY * 0.05));
        camera.fov = fov;
        camera.updateProjectionMatrix();
    });

    document.getElementById('zoomIn').onclick = () => {
        fov = Math.max(minF, fov - 5);
        camera.fov = fov;
        camera.updateProjectionMatrix();
    };
    document.getElementById('zoomOut').onclick = () => {
        fov = Math.min(maxF, fov + 5);
        camera.fov = fov;
        camera.updateProjectionMatrix();
    };
    document.getElementById('resetZoom').onclick = () => {
        fov = 75;
        camera.fov = fov;
        camera.updateProjectionMatrix();
    };
}

const fadeSections = document.querySelectorAll('.section-fade');
const fadeObserver = new IntersectionObserver((entries, observer) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            observer.unobserve(entry.target);
        }
    });
}, { threshold: 0.2 });
fadeSections.forEach(section => fadeObserver.observe(section));

function createCheckerboard() {
    const canvas = document.createElement('canvas');
    canvas.width = 128; canvas.height = 128;
    const ctx = canvas.getContext('2d');
    ctx.fillStyle = '#f0f0f0'; ctx.fillRect(0,0,128,128);
    ctx.fillStyle = '#e0e0e0'; ctx.fillRect(0,0,64,64); ctx.fillRect(64,64,64,64);
    ctx.fillStyle = '#f8f8f8'; ctx.fillRect(32,32,32,32); ctx.fillRect(96,96,32,32);
    return canvas;
}
</script>
</body>
</html>